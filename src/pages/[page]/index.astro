---
import Layout from "~layouts/Layout.astro";
import { getCollection, getEntries, getEntry } from "astro:content";
import MarkdownContent from "~components/MarkdownContent.astro";

export async function getStaticPaths() {
    const allPages = await getCollection("page", ({ data }) => {
        return !data.draft;
    });

    return allPages.map((page) => ({
        params: {
            page: page.slug
        }
    }));
}

const { page } = Astro.params;

const entry = await getEntry("page", page);
const { Content } = await entry.render();

---

<Layout
    title={entry.data.title}
    description={entry.data.description}
    sideWidth="half"
    headerImage={typeof entry.data.image === "object" ? entry.data.image.src : entry.data.image}
>
    <MarkdownContent>
        <Content />
    </Markdowncontent>
</Layout>
